@using WorkFlow.Share.Objetos.Planes

<MudCard>
    <MudCardHeader>
        <CardHeaderContent>
            <MudText Typo="Typo.h4">@PlanTrabajo.vchNombre</MudText>
        </CardHeaderContent>
    </MudCardHeader>
    <MudCardContent>
        <MudText Typo="Typo.body1" Class="mb-4">
            @((PlanTrabajo.nvchDescripcion)))
        </MudText>
        <MudText Typo="Typo.caption">
            Estatus: @(PlanTrabajo.vchEstatus)
        </MudText>


        @if (PlanTrabajo.LstModulos?.Any() == true)
        {
            <MudExpansionPanels MultiExpansion="false" Class="mt-6">
                @foreach (var modulo in PlanTrabajo.LstModulos.OrderBy(f => f.iIdModulo))
                {
                    <MudExpansionPanel>
                        <TitleContent>
                            <MudText Typo="Typo.h6">@modulo.vchTitulo</MudText>
                        </TitleContent>
                        <ChildContent>
                            <MudText Typo="Typo.body2" Class="mb-4">
                                @((modulo.nvchProposito)))
                            </MudText>

                            @if (modulo.LstFuncionalidades?.Any() == true)
                            {
                                <MudList T="Funcionalidades" Class="mt-4">
                                    @foreach (var funcion in modulo.LstFuncionalidades.OrderBy(p => p.iIdFuncionalidad))
                                    {
                                        <MudListItem>
                                            <MudText Typo="Typo.subtitle1">Función @(funcion.iIdFuncionalidad)</MudText>
                                            <MudText Typo="Typo.body2"><strong>Descripción:</strong></MudText>
                                            <MudText Typo="Typo.body2" Class="ml-4 mb-2">
                                                @((funcion.nvchDescripcion))
                                            </MudText>
                                            <MudText Typo="Typo.body2"><strong>Entidades:</strong></MudText>
                                            <MudText Typo="Typo.body2" Class="ml-4 mb-2">
                                                @((funcion.nvchEntidades))
                                            </MudText>
                                            <MudText Typo="Typo.body2"><strong>Interacciones:</strong></MudText>
                                            <MudText Typo="Typo.body2" Class="ml-4 mb-2">
                                                @((funcion.nvchInteracciones))
                                            </MudText>
                                            <MudText Typo="Typo.body2"><strong>Técnico:</strong></MudText>
                                            <MudText Typo="Typo.body2" Class="ml-4 mb-2">
                                                @((funcion.nvchTecnico))
                                            </MudText>
                                            <MudText Typo="Typo.caption">
                                                Consideraciones: @(funcion.nvchConsideraciones)
                                            </MudText>
                          

                                        </MudListItem>
                                    }
                                </MudList>
                            }
                            else
                            {
                                <MudText Typo="Typo.body2" Class="mt-4">No hay pasos definidos para esta fase.</MudText>
                            }
                        </ChildContent>
                    </MudExpansionPanel>
                }
            </MudExpansionPanels>
        }
        else
        {
            <MudText Typo="Typo.body2" Class="mt-4">No hay fases definidas para este proyecto.</MudText>
        }
    </MudCardContent>
</MudCard>

@code {
    [Parameter]
    public PlanTrabajo PlanTrabajo { get; set; } = new PlanTrabajo();
}